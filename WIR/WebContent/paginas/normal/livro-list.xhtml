<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:b="http://bootsfaces.net/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	template="/WEB-INF/modelo/padrao.xhtml">

	
<ui:define name="center">	
<b:panel title="Meus Livros " collapsible="false" >
		<h:form prependId="false" id="formListaLivrosUsuario">
		<p:commandButton id="buttonNovoLivro" 
					action="livro-form.xhtml?faces-redirect=true"
					icon="fa fa-fw fa-book"  
					value="Novo"/>
		<p:commandButton id="buttonNovaLeitura" 
					oncomplete="PF('novaLeituraLista').show();"
					icon="fa fa-fw fa-plus"  
					value="Nova Leitura"/>
		<p:splitButton value="Alterações em Lote ">
		<p:menuitem value = "Deletar" icon="fa fa-fw fa-trash"/>
		<p:menuitem value = "Baixar" icon="fa fa-fw fa-arrow-down"/>
		</p:splitButton>			
			<br/>
			<br/>
			<p:dataTable id="listaLivrosUsuario"
					var="livro" 
					value="#{livroMB.listaLivrosPessoaLogada()}"
					emptyMessage="Não existe cadastros" 
					selectionMode="multiple"
					selection="#{livroMB.livrosSelecionados}"
					paginator="true" rows="5"
					draggableColumns="true" 
					paginatorAlwaysVisible="false" >
					
				<p:column headerText="Titulo">
					<h:outputText value="#{livro.titulo}"/>
				</p:column>
				
				<p:column headerText="Autor">
					<h:outputText value="#{livro.autor}"/>
				</p:column>
				
				<p:column headerText="Paginas">
					<h:outputText value="#{livro.paginas}"/>
				</p:column>
				
				<p:column headerText="Status">
					<h:outputText value="#{livroMB.VerificaStatusLivro(livro)}"/>
				</p:column>
				
				<p:column headerText="Pontuação">
					<h:outputText />
				</p:column>
				
				<p:column headerText="Ação">
				<!-- Botao para modal Resumo -->
				<p:commandLink 
				id="comandLinkModalResumo"
				title="Visualizar ou Alterar Resumo"
				action="#{livroMB.populaObservacaoParaModal(livro)}"
				oncomplete="PF('modalResumo').show();">
				<p:graphicImage value="/resources/imagens/nota.png" 
					height="30px" width="30px"/>
				</p:commandLink>
				<!-- Botao para downlaod do pdf -->
				<p:commandLink
				id="comandLinkDownlod"
				ajax="false"
				title="Baixar livro">
				   <p:fileDownload value="#{livroMB.FileDownloadView(livro)}" />
				<p:graphicImage value="/resources/imagens/download.png"
				height="30px" width="30px"/>
				</p:commandLink>
				</p:column>				
			</p:dataTable>
			<p:remoteCommand name="updateTabelaLivro" update="listaLivrosUsuario"/>
		</h:form>
		</b:panel>
		
		<!-- Modal para realizar nova Leitura -->
		<ui:include src="/paginas/normal/livro-modal-novaLeitura.xhtml"/>
		<!-- Modal Resumo -->
		<ui:include src="/paginas/normal/livro-modal-resumo.xhtml" />

	
		<p:confirmDialog id="idModalConfirmDialog"
		widgetVar="modalconfirmaExluir"
		appendTo="@(body)"
		width="600px"
		height="40px"
		global="true"
		closable="true"
		header="Deseja deletar deletar esse livro?"
		message="Clique em Sim para deletar esse livro dos seus livros, ou cancelar para sair"
		closeOnEscape="false">
		<p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
        <p:commandButton value="Cancelar" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" style="  float: right;"/>
		
		</p:confirmDialog>
		
		</ui:define>
</ui:composition>